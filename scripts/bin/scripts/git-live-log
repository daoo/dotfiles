#!/usr/bin/env bash

# Page with cat, and then pipe through head. Using head directly as pager
# causes pipe error when head closes the pipe and git tries to continue
# writing.
export GIT_PAGER="cat"

while true; do
  find .git/HEAD .git/FETCH_HEAD .git/refs -type f | entr -dc bash -c 'lines=$(tput lines); git log --oneline --graph --decorate --all --color=always | head -n$((lines-1))'
  sleep 1
done
