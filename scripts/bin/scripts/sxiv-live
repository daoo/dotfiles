#!/usr/bin/env bash

set -ue

file="$1"

shift
opts="$@"

if [[ ! -f "$file" ]]; then
  echo "Usage: $0 FILE" 1>&2
  exit 1
fi

sxiv $opts "$file" &
pid_sxiv=$!
echo "$file" | entr xdotool search --sync --name "sxiv - $file" key r &
pid_entr=$!

wait $pid_sxiv
kill $pid_entr
